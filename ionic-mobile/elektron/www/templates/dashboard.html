<ion-view view-title="Elektron" hide-back-button="true">

    <ion-content>
      <div class="card">
        <div class="list">
              <div class="row item-divider item item-icon-right">
                <div class="col col-50 title-components"><b>Consumo en tiempo real</b></div>

                <i ng-if="websocketplay == true" ng-click="pauseWebsocket()" class="icon ion-pause positive icon-letter play-pause-icon"></i>
                <i ng-if="websocketplay == false" ng-click="playWebsocket()" class="icon ion-play positive icon-letter play-pause-icon"></i>

                <i ng-if="websocketStatus == true" ng-click="refreshConnection()" class="icon icon-letter ion-refresh balanced"></i>
                <i ng-if="websocketStatus == false" ng-click="refreshConnection()" class="icon icon-letter ion-refresh assertive"></i>
              </div>
        </div>
      </div>
      <div class="card">
          <div class="item">
            <label class="item item-input item-select">
              <div class="input-label">
                Componente
              </div>
              <select ng-options="c.label for c in components_server_enabled"
                    ng-model="current_component" ng-change="changeCurrentComponent(current_component)">
              </select>
            </label>
          </div>
          <div class="item item-text-wrap">
            <div ng-show="spinner == true" class="center-spinner">
              <ion-spinner icon="android"></ion-spinner>
            </div>
            <canvas ng-show="spinner == false" id="line" class="chart chart-line" chart-data="line.data" chart-labels="line.labels" chart-series="line.series" chart-options="options" chart-dataset-override="datasetOverride" chart-click="onClick"></canvas>
          </div>
      </div>
      <div class="card">
        <div class="list">
              <div class="row item item-divider">
                <div class="col col-50 title-components"><b>Resumen de datos</b></div>
              </div>
              <div class="item">
                <span>Componentes: </span>
                <span class="badge badge-positive badge-letter">{{components_server.length}}</span>
              </div>
              <div class="item">
                <span>Componentes conectados: </span>
                <span class="badge badge-balanced badge-letter">{{components_server_enabled.length}}</span>
              </div>
              <div class="item">
                <span>Componentes desconectados: </span>
                <span class="badge badge-assertive badge-letter">{{components_server_not_enabled.length}}</span>
              </div>
              <div class="item">
                <span>Tareas programadas: </span>
                <span class="badge badge-dark badge-letter">{{components_server.length}}</span>
              </div>
              <div class="item">
                <span>Consumo total: </span>
                <span class="badge badge-positive badge-letter"> {{ general_data.total_watts / 1000 | number : 0 }} Kw </span>
              </div>
              <div class="item">
                <span>Costo aproximado: </span>
                <span class="badge badge-calm badge-letter"> $ {{ general_data.total_tax | number : 0 }} </span>
              </div>
        </div>
        <div class="list">
          <div class="row item item-divider">
            <div class="col col-50 title-components"><b>Componentes</b></div>
            <div class="col"></div>
            <div class="col">
              <a ui-sref="app.components" class="button button-small button-positive">Ver todos</a>
            </div>
          </div>
          <div class="item" ng-repeat="component in components_server | limitTo:quantity">
            <span>{{component.label}}</span>
            <span ng-if="component.devicestate.name == 'on'" class="badge badge-balanced badge-letter">encendido</span>
            <span ng-if="component.devicestate.name == 'off'" class="badge badge-assertive badge-letter">apagado</span>
          </div>
          <div class="row item item-divider">
            <div class="col col-50 title-components"><b>Estadisticas</b></div>
            <div class="col"></div>
            <div class="col">
              <a ui-sref="app.statistics" class="button button-small button-positive">Ver estadisticas</a>
            </div>
          </div>
        </div>
      </div>
    </ion-content>
</ion-view>
